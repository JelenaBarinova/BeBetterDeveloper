<!DOCTYPE html>
<html>

  <head>
  <link rel="icon" href="http://www.bebetterdeveloper.com/img/favicon.ico" />
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Be a Better Developer</title>
  <meta name="description" content="Practical notes on development">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://www.bebetterdeveloper.com/page2/">
  <link rel="alternate" type="application/rss+xml" title="Be a Better Developer" href="http://www.bebetterdeveloper.com/feed.xml" />

  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,700' rel='stylesheet' type='text/css'>
    
  <!-- Prepare first post's image source -->



    

<!-- Open graph tags -->
<meta property="og:title" content="Be a Better Developer">
<meta property="og:type" content="website">
<meta property="og:url" content="http://www.bebetterdeveloper.com/page2/">
<meta property="og:image" content="http://www.bebetterdeveloper.com">

<meta property="og:description" content="Practical notes on development">
<meta property="og:site_name" content="Be a Better Developer">








</head>


  <body>

    <div class="site-header">

    <nav class="site-nav">
        <a class="page-link" href="/" >Home</a>
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
          <a class="page-link" href="/categories.html">Categories</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
    </nav>

    <h1>
     <span>
      <a class="site-title" href="/">Be a Better Developer</a>
     </span>
    </h1>


</div>


    <div class="page-content">
      <div class="wrapper">
        <div class="home">

  <ul class="post-list">
    
      <li>
        <!-- <span class="post-meta">Jul 16, 2015</span> -->
        <h1 style="text-align: left"><a class="post-link" href="/coding/getting-started-react-mocha.html">Getting started w/ React & Mocha</a>
          </h1>
          <p>
            <article class="post-content">
            <p><em>11/23/2015: I updated this blog post as well as the code to support the newest version of React, ReactDOM, ReactTestUtils, Mocha, JSDOM, Babel. The changed are really minor, but may be frustraiting for some. For those, who are interested in how should this code be written using older version of these libs (React 0.13.3, Mocha 2.0.1, JSDOM 3.1.2, Mocha-JSDOM 1.0.0, Babel 5.1.13) please clone this <a href="https://github.com/JelenaBarinova/react-mocha-example/tree/9b71d468a1b7af5b6366be71a3e0dee9b45e3f37">commit from GitHub</a>.</em></p>

<p>It took me half day to setup [almost] empty environment for React app development with testing done using Mocha.
I decided to share my findings here so it would remain.
<img src="/img/post_img/vfd-react-mocha.png" alt="React and Mocha logo" class="right" /></p>

<h2 id="my-target">My target</h2>
<p>I wanted to create an environment for further React development. The things that I needed to have:</p>

<ul>
  <li>source structure, that would be suitable for medium-sized project</li>
  <li>build scripts, that would do all needed transformations, run tests, show the output of my app</li>
  <li>Mocha as a test framework of choice</li>
</ul>

<p>For build scripts I prefer to use gulp.</p>

<h2 id="tldr">tl;dr</h2>
<p>You can find working code <a href="https://github.com/JelenaBarinova/react-mocha-example">here</a>. Just download it and run</p>

<pre><code>$npm install
</code></pre>

<p>followed by</p>

<pre><code>$npm test
</code></pre>

<p>If you are using Visual Studio Code - you can build it using <code>⇧⌘B</code> (on Mac).</p>

<h2 id="how-i-did-it">How I did it</h2>
<p>I started with these three stages:</p>

<ol>
  <li>Prepare the environment</li>
  <li>Create first React component</li>
  <li>Add Mocha tests</li>
</ol>

<h2 id="step-1-prepare-the-environment">Step 1. Prepare the environment</h2>
<p>First install <a href="https://nodejs.org/">Node.js</a> (if you don’t have it yet).
In your project directory (<em>react-mocha-example</em> in my case) through Terminal do:</p>

<pre><code>$npm init
</code></pre>

<p>and follow the instruction. Then run this command to install libraries to setup the working environment:</p>

<pre><code>$npm install react react-dom babel babel-preset-es2015 babel-preset-react gulp gulp-load-plugins browserify babelify babel-core vinyl-source-stream gulp-open --save-dev
</code></pre>

<p>Now your <em>package.json</em> should look like this:
<script src="https://gist.github.com/JelenaBarinova/31ce415a9beac855c75e.js"></script></p>

<p>Add <em>.babelrc</em> file to your project root with these settings:
<script src="https://gist.github.com/JelenaBarinova/23f8af665b0a8b15c855.js"></script></p>

<p>Create <em>gulpfile.js</em> to configure build steps:
<script src="https://gist.github.com/JelenaBarinova/143d0b90f977e60184fa.js"></script>
I’m using <a href="https://www.npmjs.com/package/gulp-load-plugins">gulp-load-plugins</a> for easy and fast use of different gulp plugins. It enables me to access all the plugins I have listed in package.json file without ‘require’ each of them separately.</p>

<p>So now everything is ready to start really writing a code. Create <em>index.html</em> file:
<script src="https://gist.github.com/JelenaBarinova/65ee857afca288768cb6.js"></script></p>

<p>Run build command: either using <code>⇧⌘B</code> (from Visual Studio Code on Mac) or command line:</p>

<pre><code>$gulp build
</code></pre>

<p>And you should get Chrome opened with very first version of our app.</p>

<p><img src="/img/post_img/vfd-1.png" alt="First step result" class="right" /></p>

<h2 id="step-2-create-first-react-component">Step 2. Create first React component</h2>
<p>Create a <em>components</em> directory and <em>component.jsx</em> file in it:
<script src="https://gist.github.com/JelenaBarinova/8a04f9f62934b4773b5d.js"></script></p>

<p>Add this componenet to DOM (I did it in <em>app.jsx</em> file in my project root directroy <em>react-mocha-example</em>)
<script src="https://gist.github.com/JelenaBarinova/2d3096930e0f739ab7e5.js"></script></p>

<p>Run build task and we can see our React component in a browser.</p>

<p><img src="/img/post_img/vfd-2.png" alt="Second step result" class="right" /></p>

<h2 id="step-3-adding-first-mocha-test">Step 3. Adding first Mocha test</h2>
<p>This was the trickiest step for me. I found a couple of good articles on the topic. These are my favourite:</p>

<ul>
  <li><a href="https://github.com/jesstelford/react-isomorphic-boilerplate">Isomorphic Server &amp; Browser Side Rendering with React (in 3 parts)</a></li>
  <li><a href="http://www.hammerlab.org/2015/02/14/testing-react-web-apps-with-mocha/">Testing React Web Apps with Mocha (in 2 parts)</a></li>
  <li><a href="http://www.asbjornenge.com/wwc/testing_react_components.html">Testing React Components</a></li>
</ul>

<p>Ok, let’s begin.
First, we need to install <a href="http://mochajs.org/">Mocha</a>. To do it, run npm install command with –save-dev, this way your <em>package.json</em> file will be kept updated with all the dependances you use:</p>

<pre><code>$npm install mocha --save-dev
</code></pre>

<p>Create test directory and a first <em>empty-test.js</em>, which just asserts true all the time.
<script src="https://gist.github.com/JelenaBarinova/a5a34db9c6a9cf8ccb38.js"></script></p>

<p>You can try whether it works just running Mocha from command line from you project root folder:</p>

<pre><code>$mocha
</code></pre>

<p>You shoud get this output:</p>

<p><img src="/img/post_img/vfd-3.png" alt="Third step result" class="right" /></p>

<p>Now let’s add test running step in our gulp configuration.
For this I used <a href="https://www.npmjs.com/package/gulp-mocha">gulp-mocha</a> - a gulp plugin wrapper around Mocha.</p>

<p>Now add a new ‘test’ step in <em>gulpfile.js</em> to run mocha:
<script src="https://gist.github.com/JelenaBarinova/7d65aec1091f2ded3063.js"></script></p>

<p>Before moving on to testing our React component, we need to take care of a couple of things.</p>

<p><strong>First</strong> - DOM mocking. You can find very good explanation about how to mock DOM in this <a href="http://www.asbjornenge.com/wwc/testing_react_components.html">blog post</a>.
To follow this example we need to install <a href="https://github.com/tmpvar/jsdom">jsdom</a> and <a href="https://github.com/rstacruz/mocha-jsdom">mocha-jsdom</a>.
I’ve created <em>dom-mock.js</em> file (it’s a bit different from what is given in the article, I adopted it to be compatable with the newest JSDOM version).
<script src="https://gist.github.com/JelenaBarinova/fab84f93dae04ca4123a.js"></script></p>

<p><strong>Second</strong> - install <a href="https://www.npmjs.com/package/react-addons-test-utils">React TestUtils add-on</a>:</p>

<pre><code>$npm install react-addons-test-utils --save-dev
</code></pre>

<p>And finally - the test! I’ve created <em>component-test.js</em> file in test directory:
<script src="https://gist.github.com/JelenaBarinova/c4fd4c4cdad19b28fe0f.js"></script></p>

<p>Run build. Hurray! The test is passing:</p>

<p><img src="/img/post_img/vfd-4.png" alt="Fourth step result" class="right" /></p>

<p>You can also configure your <em>package.json</em> - to run tests from command line using npm. For this add test section in your <em>package.json</em> like this:
<script src="https://gist.github.com/JelenaBarinova/085b9e9c727f166df806.js"></script></p>

<p>Now you can run:</p>

<pre><code>$npm test
</code></pre>

<p>That’s it! You can download the latest code for this example from <a href="https://github.com/JelenaBarinova/react-mocha-example">GitHub</a>.</p>

<p>Happy Testing!</p>

            </article>

            </p>
            <hr>
            <br>
      </li>
    
      <li>
        <!-- <span class="post-meta">Jul 14, 2015</span> -->
        <h1 style="text-align: left"><a class="post-link" href="/coding/es6-react-babel.html">ES2015 + React using Gulp</a>
          </h1>
          <p>
            <article class="post-content">
            <p>Recently I started exploring new features of ECMAScript 2015 while using React. So here is how I set-up my dev environment with <a href="http://gulpjs.com/">gulp</a>.
I have 2 simple steps  (running one after other in this sequence):</p>

<ol>
  <li>
    <p>Transform XLS files: I precompile React JSX template files into plain JavaScript using gulp-react: 
  <script src="https://gist.github.com/JelenaBarinova/b7b58c270e3e560056b3.js"></script></p>
  </li>
  <li>
    <p>Transform ES2015 files: I take JavaScript files, produced after first transformation and turn them into ES5 files using gulp-babel: 
  <script src="https://gist.github.com/JelenaBarinova/7245b2c53e06eb8772ab.js"></script></p>
  </li>
</ol>

<p>Here it all gathered and chained together:
<script src="https://gist.github.com/JelenaBarinova/95b2d933b6f75d6cc495.js"></script></p>

<p>In addition to two transformation tasks I like to open output in browser, for this I use gulp-open.</p>

<p>I use <a href="https://code.visualstudio.com/">Visual Studio Code</a> as my IDE, so I have set this gulp task named “build” as a build task in VS Code settings.<br />
<img src="/img/post_img/vs-code-settings.png" alt="Blog infrastructure" class="right" /></p>

<p>And now once I change code and want to check it - I just press ⇧⌘B (on Mac) and the result is in front of me.</p>

            </article>

            </p>
            <hr>
            <br>
      </li>
    
      <li>
        <!-- <span class="post-meta">Feb 24, 2014</span> -->
        <h1 style="text-align: left"><a class="post-link" href="/algorithms/sorting/sorting-heap-sort.html">Sorting: Heap Sort</a>
          </h1>
          <p>
            <article class="post-content">
            <p>I have already <a href="http://www.bebetterdeveloper.com/data-structure-max-priority-queue/">demonstrated</a> one of the binary heap usage scenarios – priority queue. Today I want to show another binary heap usage example – heap sort. The algorithm consist of two steps:</p>

<ul>
  <li>on the given set of numbers ensure max-heap invariant (<em>the value of each node is not bigger than value of its parent with biggest element at the root</em>)</li>
  <li>while heap is not empty remove first (max) item from the max-heap</li>
</ul>

<p>The first part is almost identical to the way we <a href="https://github.com/sergejusb/algorithms/blob/master/data-structures/binaryHeap.js#L20">ensured</a> binary heap invariant during delete operation. In order to make second step space efficient, we need do following things:</p>

<ul>
  <li>swap first (max) item with the last one in the max-heap</li>
  <li>decrease size of the max-heap by 1</li>
  <li>ensure max-heap invariant starting from the first item</li>
</ul>

<p>Let’s sort items [3 4 1 3 5 1 2]. As always I’ll use collors to specify <span style="color: #99cc00;">parent</span>, <span style="color: #0000ff;">child</span> or items to be <span style="color: #ff0000;">swapped</span>:</p>

<p>Step #1</p>

<p>The binary tree constructed from the given items does not conform max-heap invariant:</p>

<pre>     3
   4   1
  3 5 1 2</pre>

<p>To ensure max-heap invariant for the given set we need to take each node in the tree (except leafs) and recursively ensure it is bigger than any of the child nodes. As a reminder, our binary heap stores items starting from index 1, so we need to temporarily add null item at the begining: [null 3 4 1 3 5 1 2]</p>

<table>
  <tbody>
    <tr>
      <td>[null 3 4 <span style="color: #99cc00;">1</span> </td>
      <td>3 5 <span style="color: #0000ff;">1 2</span>]</td>
    </tr>
    <tr>
      <td>[null 3 4 <span style="color: #99cc00;">2</span> </td>
      <td>3 5 <span style="color: #0000ff;">1 1</span>]</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>[null 3 <span style="color: #99cc00;">4</span> 2</td>
      <td><span style="color: #0000ff;">3 5</span> 1 1]</td>
    </tr>
    <tr>
      <td>[null 3 <span style="color: #99cc00;">5</span> 2</td>
      <td><span style="color: #0000ff;">3 4</span> 1 1]</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>[null <span style="color: #99cc00;">3</span> <span style="color: #0000ff;">5 2</span> </td>
      <td>3 4 1 1]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #99cc00;">5</span> <span style="color: #0000ff;">3 2</span> </td>
      <td>3 4 1 1]</td>
    </tr>
    <tr>
      <td>[null 5 <span style="color: #99cc00;">3</span> 2</td>
      <td><span style="color: #0000ff;">3 4</span> 1 1]</td>
    </tr>
    <tr>
      <td>[null 5 <span style="color: #99cc00;">4</span> 2</td>
      <td><span style="color: #0000ff;">3 3</span> 1 1]</td>
    </tr>
  </tbody>
</table>

<p>At this point we have binary max-heap:</p>

<pre>     5
   4   2
  3 3 1 1</pre>
<p>Step #2</p>

<p>Swap first (max) item with the last one and ensure max-heap invariant:</p>

<table>
  <tbody>
    <tr>
      <td>[null <span style="color: #ff0000;">5</span> 4 2 3 3 1 <span style="color: #ff0000;">1</span></td>
      <td>]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #ff0000;">1</span> 4 2 3 3 1</td>
      <td><span style="color: #ff0000;">5</span>]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #99cc00;">1</span> <span style="color: #0000ff;">4 2</span> 3 3 1</td>
      <td>5]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #99cc00;">4</span> <span style="color: #0000ff;">1 2</span> 3 3 1</td>
      <td>5]</td>
    </tr>
    <tr>
      <td>[null 4 <span style="color: #99cc00;">1</span> 2 <span style="color: #0000ff;">3 3</span> 1</td>
      <td>5]</td>
    </tr>
    <tr>
      <td>[null 4 <span style="color: #99cc00;">3</span> 2 <span style="color: #0000ff;">3 1</span> 1</td>
      <td>5]</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>[null <span style="color: #ff0000;">4</span> 3 2 3 1 <span style="color: #ff0000;">1</span></td>
      <td>5]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #ff0000;">1</span> 3 2 3 1</td>
      <td><span style="color: #ff0000;">4</span> 5]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #99cc00;">1</span> <span style="color: #0000ff;">3 2</span> 3 1</td>
      <td>4 5]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #99cc00;">3</span> <span style="color: #0000ff;">1 2</span> 3 1</td>
      <td>4 5]</td>
    </tr>
    <tr>
      <td>[null 3 <span style="color: #99cc00;">1</span> 2 <span style="color: #0000ff;">3 1</span></td>
      <td>4 5]</td>
    </tr>
    <tr>
      <td>[null 3 <span style="color: #99cc00;">3</span> 2 <span style="color: #0000ff;">1 1</span></td>
      <td>4 5]</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>[null <span style="color: #ff0000;">3</span> 3 2 1 <span style="color: #ff0000;">1</span></td>
      <td>4 5]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #ff0000;">1</span> 3 2 1</td>
      <td><span style="color: #ff0000;">3</span> 4 5]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #99cc00;">1</span> <span style="color: #0000ff;">3 2</span> 1</td>
      <td>3 4 5]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #99cc00;">3</span> <span style="color: #0000ff;">1 2</span> 1</td>
      <td>3 4 5]</td>
    </tr>
    <tr>
      <td>[null 3 <span style="color: #99cc00;">1</span> 2 <span style="color: #0000ff;">1</span></td>
      <td>3 4 5]</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>[null <span style="color: #ff0000;">3</span> 1 2 <span style="color: #ff0000;">1</span></td>
      <td>3 4 5]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #ff0000;">1</span> 1 2</td>
      <td><span style="color: #ff0000;">3</span> 3 4 5]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #99cc00;">1</span> <span style="color: #0000ff;">1 2</span></td>
      <td>3 3 4 5]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #99cc00;">2</span> <span style="color: #0000ff;">1 1</span></td>
      <td>3 3 4 5]</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>[null <span style="color: #ff0000;">2</span> 1 <span style="color: #ff0000;">1</span></td>
      <td>3 3 4 5]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #ff0000;">1</span> 1</td>
      <td><span style="color: #ff0000;">2</span> 3 3 4 5]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #99cc00;">1</span> <span style="color: #0000ff;">1</span></td>
      <td>2 3 3 4 5]</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>[null <span style="color: #ff0000;">1</span> <span style="color: #ff0000;">1</span></td>
      <td>2 3 3 4 5]</td>
    </tr>
    <tr>
      <td>[null <span style="color: #ff0000;">1</span></td>
      <td><span style="color: #ff0000;">1</span> 2 3 3 4 5]</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>[null <span style="color: #ff0000;">1</span></td>
      <td>1 2 3 3 4 5]</td>
    </tr>
    <tr>
      <td>[null</td>
      <td><span style="color: #ff0000;">1</span> 1 2 3 3 4 5]</td>
    </tr>
  </tbody>
</table>

<p>Finally we remove leading null item and we have sorted items! Implementation (<a href="https://github.com/sergejusb/algorithms/blob/master/sorting/sort_tests.js">tests</a>) of the heap sort is heavily based on the binary heap implementation:</p>

<script type="text/javascript" src="http://gist-it.appspot.com/https://github.com/sergejusb/algorithms/blob/master/sorting/heapSort.js?
footer=minimal"></script>

<p><strong>Complexity</strong>: O(n·logn)</p>

            </article>

            </p>
            <hr>
            <br>
      </li>
    
  </ul>


<div>
  <div style="float: left; margin-right: 10px;">
    
      <a href="/index.html">
        <i class="fa fa-arrow-circle-left fa-2x"></i>
        <!--<span class="fa-stack fa-lg">
          <i class="fa fa-square fa-stack-2x"></i>
           <i class="fa fa-arrow-left fa-stack-1x fa-inverse"></i>
        </span>-->
      </a>
    
  </div>
  <div style="float: right; margin-left: 10px;">
    
      <a href="/page3"><i class="fa fa-arrow-circle-right fa-2x"></i></a>
    
    </div>
    </div>

</div>

      </div>
    </div>

    <div class="footer" align="center">
<div class="container">
                          <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                                       
                           <a href="https://www.linkedin.com/in/sergejus">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                      
                    
                        <a href="https://github.com/sergejusb">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    
                    
                        <a href="https://twitter.com/sergejusb">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    
                <p class="copyright text-muted">Copyright &copy; Be a Better Developer 2015</p>
            </div>
        </div>
    </div>

</div>
<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-39383708-2', 'auto');
  ga('send', 'pageview');

</script>

  </body>

</html>
